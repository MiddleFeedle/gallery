{"ast":null,"code":"const DB_NAME = 'Storage';\nconst OBJECT_STORE_NAME = 'Pictures';\n\nfunction openDatabasePromise(keyPath) {\n  return new Promise((resolve, reject) => {\n    const dbOpenRequest = window.indexedDB.open(DB_NAME, 1);\n\n    dbOpenRequest.onblocked = () => {\n      reject(\"Что-то пошло не так.\");\n    };\n\n    dbOpenRequest.onerror = err => {\n      console.log('Unable to open indexedDB ' + DB_NAME);\n      console.log(err);\n      reject('Невозможно открыть базу данных.');\n    };\n\n    dbOpenRequest.onupgradeneeded = event => {\n      const db = event.target.result;\n      var objectStore = db.createObjectStore('Pictures', {\n        keyPath: 'id',\n        autoIncrement: true\n      });\n      objectStore.createIndex(\"format\", \"format\", {\n        unique: false\n      });\n      objectStore.createIndex(\"height\", \"height\", {\n        unique: false\n      });\n      objectStore.createIndex(\"size\", \"size\", {\n        unique: false\n      });\n      objectStore.createIndex(\"type\", \"type\", {\n        unique: false\n      });\n      objectStore.createIndex(\"date\", \"date\", {\n        unique: false\n      });\n      objectStore.createIndex(\"desc\", \"desc\", {\n        unique: false\n      });\n      objectStore.createIndex(\"tags\", \"tags\", {\n        unique: false\n      });\n      objectStore.createIndex(\"value\", \"value\", {\n        unique: false\n      });\n    };\n\n    dbOpenRequest.onsuccess = () => {\n      console.info('Successfully open indexedDB connection to ' + DB_NAME);\n      resolve(dbOpenRequest.result);\n    };\n\n    dbOpenRequest.onerror = reject;\n  });\n}","map":{"version":3,"sources":["C:/Users/middl/Desktop/DevIT project/devit-project/src/db/connection.js"],"names":["DB_NAME","OBJECT_STORE_NAME","openDatabasePromise","keyPath","Promise","resolve","reject","dbOpenRequest","window","indexedDB","open","onblocked","onerror","err","console","log","onupgradeneeded","event","db","target","result","objectStore","createObjectStore","autoIncrement","createIndex","unique","onsuccess","info"],"mappings":"AACA,MAAMA,OAAO,GAAG,SAAhB;AACA,MAAMC,iBAAiB,GAAG,UAA1B;;AAGA,SAASC,mBAAT,CAA8BC,OAA9B,EAA0E;AACxE,SAAO,IAAIC,OAAJ,CAAY,CAAEC,OAAF,EAAWC,MAAX,KAAuB;AACxC,UAAMC,aAAa,GAAGC,MAAM,CAACC,SAAP,CAAiBC,IAAjB,CAAuBV,OAAvB,EAAgC,CAAhC,CAAtB;;AAEAO,IAAAA,aAAa,CAACI,SAAd,GAA0B,MAAM;AAC9BL,MAAAA,MAAM,CAAC,sBAAD,CAAN;AACD,KAFD;;AAIAC,IAAAA,aAAa,CAACK,OAAd,GAAwBC,GAAG,IAAI;AAC7BC,MAAAA,OAAO,CAACC,GAAR,CAAa,8BAA8Bf,OAA3C;AACAc,MAAAA,OAAO,CAACC,GAAR,CAAaF,GAAb;AACAP,MAAAA,MAAM,CAAE,iCAAF,CAAN;AACD,KAJD;;AAMAC,IAAAA,aAAa,CAACS,eAAd,GAAgCC,KAAK,IAAI;AACvC,YAAMC,EAAE,GAAGD,KAAK,CAACE,MAAN,CAAaC,MAAxB;AAEA,UAAIC,WAAW,GAAGH,EAAE,CAACI,iBAAH,CAAqB,UAArB,EAAiC;AAACnB,QAAAA,OAAO,EAAC,IAAT;AAAeoB,QAAAA,aAAa,EAAE;AAA9B,OAAjC,CAAlB;AAEMF,MAAAA,WAAW,CAACG,WAAZ,CAAwB,QAAxB,EAAkC,QAAlC,EAA4C;AAAEC,QAAAA,MAAM,EAAE;AAAV,OAA5C;AACAJ,MAAAA,WAAW,CAACG,WAAZ,CAAwB,QAAxB,EAAkC,QAAlC,EAA4C;AAAEC,QAAAA,MAAM,EAAE;AAAV,OAA5C;AACAJ,MAAAA,WAAW,CAACG,WAAZ,CAAwB,MAAxB,EAAgC,MAAhC,EAAwC;AAAEC,QAAAA,MAAM,EAAE;AAAV,OAAxC;AACAJ,MAAAA,WAAW,CAACG,WAAZ,CAAwB,MAAxB,EAAgC,MAAhC,EAAwC;AAAEC,QAAAA,MAAM,EAAE;AAAV,OAAxC;AACAJ,MAAAA,WAAW,CAACG,WAAZ,CAAwB,MAAxB,EAAgC,MAAhC,EAAwC;AAAEC,QAAAA,MAAM,EAAE;AAAV,OAAxC;AACAJ,MAAAA,WAAW,CAACG,WAAZ,CAAwB,MAAxB,EAAgC,MAAhC,EAAwC;AAAEC,QAAAA,MAAM,EAAE;AAAV,OAAxC;AACAJ,MAAAA,WAAW,CAACG,WAAZ,CAAwB,MAAxB,EAAgC,MAAhC,EAAwC;AAAEC,QAAAA,MAAM,EAAE;AAAV,OAAxC;AACAJ,MAAAA,WAAW,CAACG,WAAZ,CAAwB,OAAxB,EAAiC,OAAjC,EAA0C;AAAEC,QAAAA,MAAM,EAAE;AAAV,OAA1C;AAEP,KAdD;;AAiBAlB,IAAAA,aAAa,CAACmB,SAAd,GAA0B,MAAM;AAC9BZ,MAAAA,OAAO,CAACa,IAAR,CAAc,+CAA+C3B,OAA7D;AACAK,MAAAA,OAAO,CAAEE,aAAa,CAACa,MAAhB,CAAP;AACD,KAHD;;AAKAb,IAAAA,aAAa,CAACK,OAAd,GAAwBN,MAAxB;AACD,GApCM,CAAP;AAqCD","sourcesContent":["\r\nconst DB_NAME = 'Storage';\r\nconst OBJECT_STORE_NAME = 'Pictures';\r\n\r\n\r\nfunction openDatabasePromise( keyPath : string ) : Promise< IDBDatabase > {\r\n  return new Promise(( resolve, reject ) => {\r\n    const dbOpenRequest = window.indexedDB.open( DB_NAME, 1 );\r\n\r\n    dbOpenRequest.onblocked = () => {\r\n      reject(\"Что-то пошло не так.\");\r\n    };\r\n\r\n    dbOpenRequest.onerror = err => {\r\n      console.log( 'Unable to open indexedDB ' + DB_NAME );\r\n      console.log( err );\r\n      reject( 'Невозможно открыть базу данных.');\r\n    };\r\n\r\n    dbOpenRequest.onupgradeneeded = event => {\r\n      const db = event.target.result;\r\n\r\n      var objectStore = db.createObjectStore('Pictures', {keyPath:'id', autoIncrement: true});\r\n\r\n            objectStore.createIndex(\"format\", \"format\", { unique: false });\r\n            objectStore.createIndex(\"height\", \"height\", { unique: false });\r\n            objectStore.createIndex(\"size\", \"size\", { unique: false });\r\n            objectStore.createIndex(\"type\", \"type\", { unique: false });\r\n            objectStore.createIndex(\"date\", \"date\", { unique: false });\r\n            objectStore.createIndex(\"desc\", \"desc\", { unique: false });\r\n            objectStore.createIndex(\"tags\", \"tags\", { unique: false });\r\n            objectStore.createIndex(\"value\", \"value\", { unique: false });\r\n\r\n    };\r\n\r\n\r\n    dbOpenRequest.onsuccess = () => {\r\n      console.info( 'Successfully open indexedDB connection to ' + DB_NAME );\r\n      resolve( dbOpenRequest.result );\r\n    };\r\n\r\n    dbOpenRequest.onerror = reject;\r\n  } );\r\n}\r\n"]},"metadata":{},"sourceType":"module"}